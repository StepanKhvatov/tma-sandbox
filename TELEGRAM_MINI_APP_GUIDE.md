# Руководство по Telegram Mini App

## Требования и особенности Telegram Mini Apps

### 1. Основные требования

#### Технические требования:
- **HTTPS обязателен** - Telegram требует безопасное соединение
- **Размер приложения** - рекомендуется минимизировать размер бандла
- **Производительность** - быстрая загрузка критична (цель < 3 секунд)
- **Адаптивность** - поддержка разных размеров экранов
- **WebView оптимизация** - приложение работает внутри WebView Telegram

#### Безопасность:
- **Валидация initData** - всегда проверяйте данные от Telegram на сервере
- **HTTPS только** - никаких HTTP запросов
- **CSP (Content Security Policy)** - настройте для безопасности
- **XSS защита** - валидируйте весь пользовательский ввод

### 2. SEO и мета-теги

#### Важные мета-теги:
```html
<!-- Viewport для мобильных устройств -->
<meta name="viewport" content="width=device-width, initialScale=1, maximumScale=1, userScalable=no, viewportFit=cover" />

<!-- PWA манифест -->
<link rel="manifest" href="/manifest.json" />

<!-- Theme color -->
<meta name="theme-color" content="#2481cc" />

<!-- Apple Web App -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
```

#### Роботы для индексации:
- **robots: noindex, nofollow** - Telegram Mini Apps обычно не должны индексироваться поисковиками
- Это защищает приватность и предотвращает прямой доступ вне Telegram

### 3. Манифест (manifest.json)

#### Обязательные поля:
- `name` - полное название приложения
- `short_name` - короткое название (до 12 символов)
- `start_url` - стартовая страница
- `display` - режим отображения (standalone для полноэкранного режима)
- `icons` - иконки для разных размеров (минимум 192x192 и 512x512)

#### Рекомендации:
- Используйте PNG формат для иконок
- Иконки должны быть maskable (работают с разными форматами)
- Theme color должен соответствовать цветовой схеме приложения

### 4. Производительность

#### Оптимизация загрузки:
1. **Code Splitting** - используйте динамические импорты
2. **Lazy Loading** - загружайте компоненты по требованию
3. **Image Optimization** - используйте Next.js Image компонент
4. **Минификация** - автоматически в Next.js production build

#### Целевые метрики:
- **First Contentful Paint (FCP)**: < 1.8s
- **Time to Interactive (TTI)**: < 3.8s
- **Largest Contentful Paint (LCP)**: < 2.5s
- **Cumulative Layout Shift (CLS)**: < 0.1

### 5. Интеграция с Telegram Web App API

#### Инициализация:
```typescript
// Установка SDK
npm install @telegram-apps/sdk-react

// Использование
import { SDKProvider, useSDK } from '@telegram-apps/sdk-react';
```

#### Основные возможности:
- `initData` - данные пользователя от Telegram
- `MainButton` - кнопка внизу экрана
- `BackButton` - кнопка назад
- `HapticFeedback` - тактильная обратная связь
- `CloudStorage` - облачное хранилище
- `BiometricManager` - биометрия

### 6. Стилизация и UI

#### Рекомендации:
- Используйте нативные стили Telegram (цвета, шрифты)
- Адаптируйте под тему Telegram (светлая/темная)
- Минимизируйте использование кастомных шрифтов
- Оптимизируйте для сенсорного ввода (большие кнопки, отступы)

#### Цветовая схема Telegram:
- **Primary**: #2481cc (синий Telegram)
- **Background**: #ffffff (светлая) / #212121 (темная)
- **Text**: #000000 (светлая) / #ffffff (темная)

### 7. Обработка ошибок

#### Важные моменты:
- Обрабатывайте ошибки сети (Telegram может быть офлайн)
- Валидируйте данные от Telegram на сервере
- Показывайте понятные сообщения об ошибках пользователю
- Логируйте ошибки для отладки

### 8. Тестирование

#### Рекомендации:
- Тестируйте на реальных устройствах
- Проверяйте в разных версиях Telegram
- Тестируйте на iOS и Android
- Проверяйте производительность на медленных сетях
- Используйте DevTools для отладки

### 9. Деплой

#### Требования:
- HTTPS обязателен
- Доменное имя (не IP)
- Валидный SSL сертификат
- Настройка CORS при необходимости

#### Рекомендуемые платформы:
- **Vercel** - отличная поддержка Next.js
- **Netlify** - простая настройка
- **Railway** - для более сложных случаев
- **Собственный сервер** - если нужен полный контроль

### 10. Регистрация в Telegram

#### Шаги:
1. Создайте бота через @BotFather
2. Настройте команду `/newapp` или `/setmenubutton`
3. Укажите URL вашего приложения
4. Укажите название и описание
5. Добавьте иконку приложения

#### Важно:
- URL должен быть HTTPS
- Приложение должно быть доступно публично
- Иконка должна быть 640x360 пикселей

## Советы по разработке

### 1. Оптимизация размера
- Используйте динамические импорты для больших библиотек
- Минимизируйте зависимости
- Используйте tree-shaking

### 2. Кэширование
- Настройте правильные заголовки кэширования
- Используйте Service Workers для офлайн работы (опционально)
- Кэшируйте статические ресурсы

### 3. Безопасность
- Всегда валидируйте initData на сервере
- Используйте HTTPS для всех запросов
- Не храните чувствительные данные в localStorage
- Используйте безопасные методы аутентификации

### 4. UX/UI
- Следуйте гайдлайнам Telegram
- Используйте нативные компоненты где возможно
- Обеспечьте плавные анимации
- Оптимизируйте для одной руки (большие кнопки)

### 5. Мониторинг
- Настройте аналитику (Telegram Analytics или другие)
- Отслеживайте производительность
- Мониторьте ошибки (Sentry, LogRocket)
- Собирайте метрики пользователей

## Полезные ссылки

- [Telegram Mini Apps Documentation](https://core.telegram.org/bots/webapps)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Next.js Documentation](https://nextjs.org/docs)
- [Web App Manifest](https://developer.mozilla.org/en-US/docs/Web/Manifest)

## Чеклист перед запуском

- [ ] HTTPS настроен и работает
- [ ] Манифест создан и доступен
- [ ] Мета-теги настроены
- [ ] Иконки созданы (192x192, 512x512)
- [ ] Производительность оптимизирована
- [ ] Тестирование на реальных устройствах
- [ ] Валидация initData на сервере
- [ ] Обработка ошибок настроена
- [ ] Аналитика настроена
- [ ] Приложение зарегистрировано в Telegram

